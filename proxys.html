<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Math Notes - Search</title>
  <meta name="theme-color" content="#040d01">
  <meta name="description" content="Web Proxy - AirAI Platform">
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <link rel="apple-touch-icon" href="icons/icon-192x192.svg">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #0a1f0a;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      color: #e8f5e9;
      position: relative;
      overflow-x: hidden;
    }

    /* Animated Background */
    .background-animation {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      z-index: 0; overflow: hidden; pointer-events: none;
    }

    .bg-gradient {
      position: absolute; border-radius: 50%;
      filter: blur(80px); opacity: 0.3;
      animation: float 20s infinite ease-in-out;
    }
    .bg-gradient-1 { width: 500px; height: 500px; background: radial-gradient(circle, #2e7d32, #1b5e20); top: -10%; left: -10%; }
    .bg-gradient-2 { width: 400px; height: 400px; background: radial-gradient(circle, #1b5e20, #0d2818); top: 50%; right: -5%; animation-delay: 7s; }
    .bg-gradient-3 { width: 600px; height: 600px; background: radial-gradient(circle, #2e7d32, #0a1f0a); bottom: -15%; left: 30%; animation-delay: 14s; }

    .grid-pattern {
      position: absolute; width: 100%; height: 100%;
      background-image:
        linear-gradient(rgba(46,125,50,0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(46,125,50,0.03) 1px, transparent 1px);
      background-size: 50px 50px;
      animation: gridMove 30s linear infinite;
    }

    @keyframes float { 0%,100%{transform:translate(0,0) scale(1)} 33%{transform:translate(30px,-30px) scale(1.1)} 66%{transform:translate(-20px,20px) scale(0.9)} }
    @keyframes gridMove { 0%{transform:translate(0,0)} 100%{transform:translate(50px,50px)} }
    @keyframes fadeUp { from{opacity:0;transform:translateY(16px)} to{opacity:1;transform:translateY(0)} }
    @keyframes glow { 0%,100%{box-shadow:0 0 20px rgba(46,125,50,0.4)} 50%{box-shadow:0 0 40px rgba(46,125,50,0.6)} }
    @keyframes spin { to{transform:rotate(360deg)} }

    .header, .main-content, .page-footer { position: relative; z-index: 1; }

    /* Header */
    .header {
      background: #0d2818; border-bottom: 1px solid #1a3d2e; padding: 16px 0;
    }
    .header-content {
      max-width: 1200px; margin: 0 auto; padding: 0 24px;
      display: flex; align-items: center; justify-content: space-between;
    }
    .logo { display: flex; align-items: center; gap: 12px; text-decoration: none; }
    .logo-icon {
      width: 32px; height: 32px;
      background: linear-gradient(135deg, #2e7d32, #1b5e20);
      border-radius: 8px; display: flex; align-items: center; justify-content: center;
      box-shadow: 0 0 20px rgba(46,125,50,0.4);
    }
    .logo-icon svg { width: 18px; height: 18px; color: #c8e6c9; }
    .logo-text { font-size: 20px; font-weight: 700; color: #c8e6c9; }

    .header-links { display: flex; gap: 16px; align-items: center; }
    .header-btn {
      background: none; border: 1px solid #2e7d32; color: #81c784;
      padding: 8px 16px; border-radius: 8px; font-size: 13px; font-weight: 600;
      cursor: pointer; font-family: inherit; transition: all 0.2s;
    }
    .header-btn:hover { background: rgba(46,125,50,0.15); color: #c8e6c9; }
    .header-btn.active { background: #2e7d32; color: #c8e6c9; }

    /* Main */
    .main-content {
      flex: 1; display: flex; flex-direction: column; align-items: center;
      justify-content: flex-start; padding: 60px 24px 48px;
    }

    /* Search Hero */
    .search-hero {
      text-align: center; margin-bottom: 40px; animation: fadeUp 0.5s ease;
    }
    .search-hero-icon {
      width: 72px; height: 72px;
      background: linear-gradient(135deg, #2e7d32, #1b5e20);
      border-radius: 18px; display: flex; align-items: center; justify-content: center;
      margin: 0 auto 20px; animation: glow 3s infinite;
    }
    .search-hero-icon svg { width: 36px; height: 36px; color: #c8e6c9; }
    .search-hero h1 {
      font-size: 32px; font-weight: 800; color: #c8e6c9; margin-bottom: 8px;
    }
    .search-hero p { font-size: 15px; color: #6b9b6b; max-width: 480px; line-height: 1.6; }

    /* Search Box */
    .search-container {
      width: 100%; max-width: 640px; margin-bottom: 32px; animation: fadeUp 0.5s ease 0.1s both;
    }
    .search-wrapper {
      display: flex; gap: 0;
      background: #0d2818; border: 2px solid #1a3d2e; border-radius: 14px;
      overflow: hidden; transition: border-color 0.2s, box-shadow 0.2s;
    }
    .search-wrapper:focus-within {
      border-color: #2e7d32; box-shadow: 0 0 0 3px rgba(46,125,50,0.25);
    }
    .search-input {
      flex: 1; border: none; background: transparent; color: #e8f5e9;
      font-size: 15px; font-family: inherit; padding: 16px 20px;
      outline: none;
    }
    .search-input::placeholder { color: #4a7a4a; }
    .search-btn {
      background: linear-gradient(135deg, #2e7d32, #1b5e20); border: none;
      color: #c8e6c9; padding: 16px 24px; cursor: pointer;
      display: flex; align-items: center; gap: 8px;
      font-size: 14px; font-weight: 600; font-family: inherit;
      transition: all 0.2s; white-space: nowrap;
    }
    .search-btn:hover { background: linear-gradient(135deg, #388e3c, #2e7d32); }
    .search-btn svg { width: 18px; height: 18px; }

    /* Mode Tabs */
    .mode-tabs {
      display: flex; gap: 8px; margin-bottom: 24px; animation: fadeUp 0.5s ease 0.15s both;
    }
    .mode-tab {
      background: rgba(13,40,24,0.6); border: 1px solid #1a3d2e;
      color: #6b9b6b; padding: 10px 20px; border-radius: 10px;
      font-size: 13px; font-weight: 600; cursor: pointer; font-family: inherit;
      transition: all 0.2s; display: flex; align-items: center; gap: 6px;
    }
    .mode-tab:hover { border-color: #2e7d32; color: #81c784; }
    .mode-tab.active { background: rgba(46,125,50,0.15); border-color: #2e7d32; color: #c8e6c9; }
    .mode-tab svg { width: 14px; height: 14px; }

    /* Results Area */
    .results-area {
      width: 100%; max-width: 640px; animation: fadeUp 0.5s ease 0.2s both;
    }
    .results-header {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 16px; padding: 0 4px;
    }
    .results-title { font-size: 14px; font-weight: 600; color: #81c784; }
    .results-count { font-size: 12px; color: #4a7a4a; }

    .result-card {
      background: rgba(13,40,24,0.5); border: 1px solid #1a3d2e;
      border-radius: 12px; padding: 16px 20px; margin-bottom: 10px;
      cursor: pointer; transition: all 0.2s;
    }
    .result-card:hover {
      border-color: #2e7d32; background: rgba(13,40,24,0.8);
      transform: translateY(-1px); box-shadow: 0 4px 20px rgba(0,0,0,0.3);
    }
    .result-url { font-size: 12px; color: #4a7a4a; margin-bottom: 4px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .result-title { font-size: 15px; font-weight: 600; color: #81c784; margin-bottom: 6px; }
    .result-snippet { font-size: 13px; color: #6b9b6b; line-height: 1.5; }

    /* Direct URL input */
    .url-section {
      width: 100%; max-width: 640px; margin-top: 8px;
      animation: fadeUp 0.5s ease 0.25s both;
    }
    .url-hint {
      font-size: 12px; color: #4a7a4a; text-align: center;
      margin-top: 16px; line-height: 1.5;
    }

    /* Loading */
    .loading {
      display: none; text-align: center; padding: 40px;
    }
    .loading.show { display: block; }
    .loading-spinner {
      width: 32px; height: 32px; border: 3px solid #1a3d2e;
      border-top-color: #2e7d32; border-radius: 50%;
      animation: spin 0.8s linear infinite; margin: 0 auto 12px;
    }
    .loading-text { font-size: 13px; color: #6b9b6b; }

    /* Empty state */
    .empty-state {
      text-align: center; padding: 48px 24px; color: #4a7a4a;
    }
    .empty-state svg { width: 48px; height: 48px; margin-bottom: 16px; opacity: 0.4; }
    .empty-state p { font-size: 14px; line-height: 1.6; }

    /* Toast */
    .toast {
      position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%) translateY(80px);
      background: #0d2818; border: 1px solid #2e7d32; border-radius: 10px;
      padding: 12px 20px; color: #c8e6c9; font-size: 13px; font-weight: 500;
      box-shadow: 0 8px 32px rgba(0,0,0,0.5); z-index: 500;
      transition: transform 0.3s ease; display: flex; align-items: center; gap: 8px;
    }
    .toast.show { transform: translateX(-50%) translateY(0); }

    /* Footer */
    .page-footer {
      text-align: center; padding: 24px; border-top: 1px solid #1a3d2e;
      background: #0d2818;
    }
    .page-footer p { font-size: 12px; color: #4a7a4a; }

    /* Iframe overlay for browsing */
    .browse-overlay {
      display: none; position: fixed; inset: 0;
      background: #0a1f0a; z-index: 9999;
      flex-direction: column;
    }
    .browse-overlay.show { display: flex; }

    .browse-toolbar {
      display: flex; align-items: center; gap: 8px;
      background: #0d2818; border-bottom: 1px solid #1a3d2e;
      padding: 8px 16px; flex-shrink: 0;
    }
    .browse-back-btn {
      background: rgba(46,125,50,0.15); border: 1px solid #2e7d32; color: #81c784;
      padding: 8px 14px; border-radius: 8px; font-size: 13px; font-weight: 600;
      cursor: pointer; font-family: inherit; transition: all 0.2s;
      display: flex; align-items: center; gap: 6px;
    }
    .browse-back-btn:hover { background: #2e7d32; color: #c8e6c9; }
    .browse-back-btn svg { width: 14px; height: 14px; }
    .browse-url-bar {
      flex: 1; background: #0a1f0a; border: 1px solid #1a3d2e; border-radius: 8px;
      padding: 8px 14px; color: #6b9b6b; font-size: 13px; font-family: inherit;
      outline: none; transition: border-color 0.2s;
    }
    .browse-url-bar:focus { border-color: #2e7d32; color: #c8e6c9; }
    .browse-go-btn {
      background: linear-gradient(135deg, #2e7d32, #1b5e20); border: none;
      color: #c8e6c9; padding: 8px 16px; border-radius: 8px; font-size: 13px;
      font-weight: 600; cursor: pointer; font-family: inherit; transition: all 0.2s;
    }
    .browse-go-btn:hover { background: linear-gradient(135deg, #388e3c, #2e7d32); }
    .browse-cloak-btn {
      background: none; border: 1px solid #1a3d2e; color: #6b9b6b;
      padding: 8px 12px; border-radius: 8px; font-size: 12px; font-weight: 600;
      cursor: pointer; font-family: inherit; transition: all 0.2s;
      white-space: nowrap;
    }
    .browse-cloak-btn:hover { border-color: #2e7d32; color: #81c784; }

    .browse-frame {
      flex: 1; border: none; width: 100%; background: #fff;
    }

    @media (max-width: 640px) {
      .search-hero h1 { font-size: 24px; }
      .header-links { gap: 8px; }
      .header-btn { padding: 6px 10px; font-size: 12px; }
      .mode-tabs { flex-wrap: wrap; justify-content: center; }
      .browse-toolbar { flex-wrap: wrap; }
    }
  </style>
</head>
<body>

<div class="background-animation">
  <div class="bg-gradient bg-gradient-1"></div>
  <div class="bg-gradient bg-gradient-2"></div>
  <div class="bg-gradient bg-gradient-3"></div>
  <div class="grid-pattern"></div>
</div>

<!-- Header -->
<header class="header">
  <div class="header-content">
    <a href="#" class="logo">
      <div class="logo-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
          <path d="M13 10V3L4 14h7v7l9-11h-7z"/>
        </svg>
      </div>
      <span class="logo-text">AirAI ¬∑ Proxy</span>
    </a>
    <div class="header-links">
      <button class="header-btn" onclick="openAboutBlank()" title="Open this page in about:blank">
        üõ°Ô∏è Cloak
      </button>
    </div>
  </div>
</header>

<!-- Main Content -->
<main class="main-content">
  <div class="search-hero">
    <div class="search-hero-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="11" cy="11" r="8"/>
        <line x1="21" y1="21" x2="16.65" y2="16.65"/>
      </svg>
    </div>
    <h1>Web Proxy</h1>
    <p>Search Google or enter a URL directly. Results open in a cloaked browser so nothing shows in your history.</p>
  </div>

  <!-- Search Box -->
  <div class="search-container">
    <div class="search-wrapper">
      <input type="text" id="searchInput" class="search-input" placeholder="Search Google or enter a URL..." autocomplete="off" autofocus>
      <button class="search-btn" onclick="performSearch()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"/>
          <line x1="21" y1="21" x2="16.65" y2="16.65"/>
        </svg>
        Search
      </button>
    </div>
  </div>

  <!-- Mode Tabs -->
  <div class="mode-tabs">
    <button class="mode-tab active" data-mode="search" onclick="switchMode('search')">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
      Search
    </button>
    <button class="mode-tab" data-mode="url" onclick="switchMode('url')">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>
      Direct URL
    </button>
  </div>

  <!-- Results Area -->
  <div class="results-area" id="resultsArea">
    <div class="empty-state" id="emptyState">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <circle cx="11" cy="11" r="8"/>
        <line x1="21" y1="21" x2="16.65" y2="16.65"/>
      </svg>
      <p>Type a search query and press Enter to search Google.<br>Or switch to <strong>Direct URL</strong> mode to open any site.</p>
    </div>
    <div class="loading" id="loading">
      <div class="loading-spinner"></div>
      <div class="loading-text">Searching Google...</div>
    </div>
    <div id="resultsList"></div>
  </div>

  <div class="url-hint">
    All results open in an embedded browser. Click "Cloak" to pop out to an about:blank tab.
  </div>
</main>

<!-- Footer -->
<footer class="page-footer">
  <p>&copy; 2026 AirAI, Inc. All rights reserved. &middot; <span style="color: #4a6b4a;">v1.5</span></p>
</footer>

<!-- Browse Overlay (embedded browser) -->
<div class="browse-overlay" id="browseOverlay">
  <div class="browse-toolbar">
    <button class="browse-back-btn" onclick="closeBrowse()">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
      Back
    </button>
    <input type="text" class="browse-url-bar" id="browseUrlBar" placeholder="URL" readonly>
    <button class="browse-go-btn" onclick="navigateBrowse()">Go</button>
    <button class="browse-cloak-btn" onclick="cloakCurrent()">üõ°Ô∏è Pop to about:blank</button>
  </div>
  <iframe class="browse-frame" id="browseFrame" sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox" allowfullscreen></iframe>
</div>

<!-- Toast -->
<div class="toast" id="toast"></div>

<script>
  // ==========================
  // STATE
  // ==========================
  let currentMode = 'search';
  let currentBrowseUrl = '';

  // ==========================
  // SEARCH INPUT HANDLING
  // ==========================
  document.getElementById('searchInput').addEventListener('keydown', function(e) {
    if (e.key === 'Enter') performSearch();
  });

  function switchMode(mode) {
    currentMode = mode;
    document.querySelectorAll('.mode-tab').forEach(t => t.classList.remove('active'));
    document.querySelector('[data-mode="' + mode + '"]').classList.add('active');

    const input = document.getElementById('searchInput');
    if (mode === 'search') {
      input.placeholder = 'Search Google or enter a URL...';
    } else {
      input.placeholder = 'Enter a URL (e.g. example.com)...';
    }
    input.focus();
  }

  // ==========================
  // DETECT IF INPUT IS A URL
  // ==========================
  function looksLikeUrl(str) {
    return /^(https?:\/\/)/i.test(str) ||
           /^[a-zA-Z0-9]([a-zA-Z0-9-]*\.)+[a-zA-Z]{2,}(\/.*)?$/.test(str);
  }

  function ensureProtocol(url) {
    if (!/^https?:\/\//i.test(url)) return 'https://' + url;
    return url;
  }

  // ==========================
  // PERFORM SEARCH / OPEN URL
  // ==========================
  function performSearch() {
    var query = document.getElementById('searchInput').value.trim();
    if (!query) return;

    if (currentMode === 'url' || looksLikeUrl(query)) {
      openInBrowse(ensureProtocol(query));
    } else {
      doGoogleSearch(query);
    }
  }

  // ==========================
  // GOOGLE SEARCH via scraping
  // ==========================
  function doGoogleSearch(query) {
    var resultsList = document.getElementById('resultsList');
    var emptyState = document.getElementById('emptyState');
    var loading = document.getElementById('loading');

    emptyState.style.display = 'none';
    resultsList.innerHTML = '';
    loading.classList.add('show');

    // Use Google search URL directly in the embedded browser
    var googleUrl = 'https://www.google.com/search?igu=1&q=' + encodeURIComponent(query);
    loading.classList.remove('show');
    openInBrowse(googleUrl);
  }

  // ==========================
  // EMBEDDED BROWSER
  // ==========================
  function openInBrowse(url) {
    currentBrowseUrl = url;
    document.getElementById('browseUrlBar').value = url;
    document.getElementById('browseFrame').src = url;
    document.getElementById('browseOverlay').classList.add('show');
  }

  function closeBrowse() {
    document.getElementById('browseOverlay').classList.remove('show');
    document.getElementById('browseFrame').src = '';
    currentBrowseUrl = '';
  }

  function navigateBrowse() {
    var url = document.getElementById('browseUrlBar').value.trim();
    if (!url) return;
    url = ensureProtocol(url);
    openInBrowse(url);
  }

  document.getElementById('browseUrlBar').addEventListener('keydown', function(e) {
    if (e.key === 'Enter') navigateBrowse();
  });
  // Make URL bar editable when clicked
  document.getElementById('browseUrlBar').addEventListener('focus', function() {
    this.removeAttribute('readonly');
  });
  document.getElementById('browseUrlBar').addEventListener('blur', function() {
    this.setAttribute('readonly', '');
  });

  // ==========================
  // CLOAK TO ABOUT:BLANK
  // ==========================
  function cloakCurrent() {
    var url = currentBrowseUrl || document.getElementById('browseUrlBar').value.trim();
    if (!url) { showToast('No URL to cloak'); return; }
    url = ensureProtocol(url);
    openCloaked(url);
    closeBrowse();
    showToast('Opened in about:blank tab');
  }

  function openAboutBlank() {
    openCloaked(window.location.href);
    window.location.replace('https://google.com');
  }

  function openCloaked(url) {
    var win = window.open('about:blank', '_blank');
    if (win) {
      win.document.title = 'Math Notes';
      var link = win.document.createElement('link');
      link.rel = 'icon';
      link.type = 'image/svg+xml';
      link.href = new URL('favicon.svg', window.location.href).href;
      win.document.head.appendChild(link);

      win.document.body.style.margin = '0';
      win.document.body.style.height = '100vh';
      win.document.body.style.overflow = 'hidden';
      var iframe = win.document.createElement('iframe');
      iframe.style.border = 'none';
      iframe.style.width = '100%';
      iframe.style.height = '100%';
      iframe.style.margin = '0';
      iframe.style.position = 'fixed';
      iframe.style.top = '0';
      iframe.style.left = '0';
      iframe.src = url;
      win.document.body.appendChild(iframe);
    }
  }

  // ==========================
  // TOAST
  // ==========================
  function showToast(msg) {
    var toast = document.getElementById('toast');
    toast.textContent = msg;
    toast.classList.add('show');
    setTimeout(function() { toast.classList.remove('show'); }, 2500);
  }
</script>

</body>
</html>
